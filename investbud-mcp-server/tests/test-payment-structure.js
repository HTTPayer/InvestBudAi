// Test script to demonstrate the X402 payment structure

// Simulated payment data (as generated by the payment bridge)
const paymentData = {
  x402Version: 1,
  scheme: "exact",
  network: "base-sepolia",
  payload: {
    signature: "0x1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef12",
    authorization: {
      from: "0x364307720164378324965c27fae21242fd5807ee",
      to: "0xPayToAddress123456789012345678901234567890",
      value: "100000",
      validAfter: "1732800000",
      validBefore: "1732800900",
      nonce: "0xabc123def456789012345678901234567890abcdef123456789012345678901234"
    }
  }
};

// Encode to base64 (this goes in the X-PAYMENT header)
const paymentHeader = Buffer.from(JSON.stringify(paymentData)).toString('base64');

// Extract data for payload
const payloadToSend = {
  network: paymentData.network,
  address: paymentData.payload.authorization.from
};

console.log("=== X-PAYMENT HEADER ===");
console.log("Header Name: X-PAYMENT");
console.log("Header Value (base64):", paymentHeader);
console.log("\n=== DECODED HEADER ===");
console.log(JSON.stringify(paymentData, null, 2));

console.log("\n=== REQUEST PAYLOAD ===");
console.log(JSON.stringify(payloadToSend, null, 2));

console.log("\n=== EXAMPLE REQUEST ===");
console.log("POST /api/endpoint");
console.log("Headers:");
console.log(`  X-PAYMENT: ${paymentHeader}`);
console.log(`  Content-Type: application/json`);
console.log("Body:");
console.log(JSON.stringify(payloadToSend, null, 2));
